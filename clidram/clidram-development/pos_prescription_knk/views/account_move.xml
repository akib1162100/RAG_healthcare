<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="account_move_pos_prescription" model="ir.ui.view">
        <field name="name">account.move.account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_shipping_id']" position="before">
                <field name="referral_partner_id" attrs="{'readonly':[('state','!=','draft')],'invisible':[('move_type','!=','out_invoice')]}" />
                <field name="source_doctor_id" attrs="{'readonly':[('state','!=','draft')],'invisible':[('move_type','!=','out_invoice')]}" />
                <field name="age" attrs="{'invisible':[('move_type','!=','out_invoice')]}" />
                <field name="gender" attrs="{'invisible':[('move_type','!=','out_invoice')]}" />
                <field name="accession_no" attrs="{'readonly':[('state','!=','draft')],'invisible':[('move_type','!=','out_invoice')]}" />
                <field name="radiology_created" invisible="1" />
                <field name="radiology_id"/>
            </xpath>
            <xpath expr="//page[@name='other_info']//field[@name='ref']" position="replace">
                <field name="ref" nolabel="1" attrs="{'readonly':[('state','!=','draft')]}" />
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='product_id']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='price_unit']" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='tax_ids']" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='name']" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath>
            <xpath expr="//button[@name='button_draft']" position="after">
                <button name="action_create_radiology_req" type="object" class="oe_highlight" string="Radiology Request" attrs="{'invisible':['|',('state','!=','posted'),('radiology_created','=',True)]}" />
            </xpath>
            <xpath expr="//label[@for='partner_id'][1]" position="replace">
                <label for="partner_id" string="Patient" style="font-weight:bold;" attrs="{'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'out_receipt'))]}" />
            </xpath>
            <!-- <xpath expr="//field[@name='l10n_in_state_id'" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>    
             <xpath expr="//field[@name='l10n_in_gst_treatment']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath> -->

<!--            <xpath expr="//sheet/div[hasclass('oe_title')]/h1" position="replace">-->
<!--                <h1>-->
<!--                    <field name="custom_reference" readonly="1" force_save="1" attrs="{'invisible': [('move_type', '!=', 'out_invoice')]}"/>-->
<!--                    <field name="name" attrs="{'invisible': [('move_type', '=', 'out_invoice')], 'readonly': [('state', '!=', 'draft')]}"/>-->
<!--                </h1>-->
<!--            </xpath>-->

<!--            <xpath expr="//sheet/group[1]/group[1]/field[@name='ref'][2]" position="after">-->
<!--                <field name="name" string="Odoo Reference" attrs="{'invisible': [('move_type', '!=', 'out_invoice')], 'readonly': [('state', '!=', 'draft')]}"/>-->
<!--            </xpath>-->
        </field>
    </record>
    <record id="view_invoice_tree_pos_prescription" model="ir.ui.view">
        <field name="name">account.invoice.tree.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='invoice_partner_display_name']" position="after">
                <field name="referral_partner_id" />
                <field name="source_doctor_id" />
                <field name="patient_type_id" />
                <field name="kmc_num" optional="hide" />
                <field name="bed_num" optional="hide" />
            </xpath>

<!--            <xpath expr="//tree/field[@name='name']" position="before">-->
<!--                <field name="custom_reference" readonly="1" force_save="1" string="Reference"/>-->
<!--            </xpath>-->
        </field>
    </record>
    <record id="account_invoice_report_pos_prescription_view_search" model="ir.ui.view">
        <field name="name">account.invoice.report.search.inherit</field>
        <field name="model">account.invoice.report</field>
        <field name="inherit_id" ref="account.view_account_invoice_report_search" />
        <field name="arch" type="xml">
            <filter name="user" position="after">
                <filter string="Referral" name="referral_partner_id" context="{'group_by':'referral_partner_id'}" />
                <filter string="Source Doctor" name="source_doctor_id" context="{'group_by':'source_doctor_id'}" />
                <filter string="Product" name="product_id" context="{'group_by':'product_id'}" />
            </filter>
        </field>
    </record>
    <!-- Pricelist -->
    <record id="view_account_move_customer_form" model="ir.ui.view">
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">
            <button name="action_invoice_sent" position="before">
                <button type="object" name="button_update_prices_from_pricelist" groups="product.group_product_pricelist" string="Update prices" attrs="{'invisible': ['|', '|', ('pricelist_id', '=', False), ('state', 'not in', ['draft']), ('move_type', 'not in', ['out_invoice', 'out_refund'])]}" help="Update price in lines from the pricelist" />
            </button>
            <xpath expr="//group[@id='header_right_group']//field[@name='currency_id']" position="attributes">
                <attribute name="attrs">{'readonly': [('pricelist_id', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//group[@id='header_right_group']/field[@name='currency_id']" position="attributes">
                <attribute name="attrs">{'readonly': [('pricelist_id', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//div[field[@name='journal_id']]" position="after">
                <field name="patient_type_id" attrs="{'invisible': [('move_type', 'not in', ['out_invoice'])]}" />
                <field name="patient_type_name" invisible="1" />
                <field name="kmc_num" attrs="{'invisible':[('patient_type_name','!=','IPD')],'required':[('patient_type_name','=','IPD')]}" />
                <field name="ward_num" attrs="{'invisible':[('patient_type_name','!=','IPD')]}" />
                <field name="bed_num" attrs="{'invisible':[('patient_type_name','!=','IPD')],'required':[('patient_type_name','=','IPD')]}" />
                <field name="pricelist_id" invisible="1" groups="!product.group_product_pricelist" />
                <field name="pricelist_id" groups="product.group_product_pricelist" attrs="{'invisible': [('move_type', 'not in', ['out_invoice', 'out_refund'])]}" />
            </xpath>
        </field>
    </record>
    <record id="view_account_invoice_filter" model="ir.ui.view">
        <field name="name">account.invoice.select.account_pricelist</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_account_invoice_filter" />
        <field name="arch" type="xml">
            <xpath expr="//group/filter[@name='status']" position="after">
                <filter string="Pricelist" name="pricelist" groups="product.group_product_pricelist" context="{'group_by':'pricelist_id'}" invisible="context.get('default_move_type', '') not in ['out_invoice', 'out_refund']" />
            </xpath>

<!--            <xpath expr="//search/field[@name='name']" position="after">-->
<!--                <field name="custom_reference"/>-->
<!--            </xpath>-->
<!--            <xpath expr="//search/field[@name='name']" position="attributes">-->
<!--                    <attribute name="filter_domain">['|', '|' , '|', '|', '|', ('name', 'ilike', self), ('invoice_origin', 'ilike', self), ('ref', 'ilike', self), ('payment_reference', 'ilike', self), ('partner_id', 'child_of', self), ('custom_reference', 'ilike', self)]</attribute>-->
<!--            </xpath>-->
        </field>
    </record>
    <menuitem id="menu_product_pricelist_main" parent="account.menu_finance_receivables" name="Pricelists" action="product.product_pricelist_action2" groups="product.group_product_pricelist" sequence="105" />
</odoo>